const e={dev:!0,header:"#built using mc-build (https://github.com/mc-build/mc-build)",internalScoreboard:"LANG_MC_INTERNAL",generatedDirectory:"__generated__",rootNamespace:null,defaultNamespace:null};const t=new class{constructor(){this.data=e}get dev(){return this.data.dev}set dev(e){this.data.dev=e}get header(){return this.data.header}set header(e){this.data.header=e}get internalScoreboard(){return this.data.internalScoreboard}set internalScoreboard(e){this.data.internalScoreboard=e}get generatedDirectory(){return this.data.generatedDirectory}set generatedDirectory(e){this.data.generatedDirectory=e}get rootNamespace(){return this.data.rootNamespace}set rootNamespace(e){this.data.rootNamespace=e}get defaultNamespace(){return this.data.defaultNamespace}set defaultNamespace(e){this.data.defaultNamespace=e}};var n={log:function(...e){return self.postMessage({channel:"LOG",msg:e.join(" ")})},error:function(...e){return self.postMessage({channel:"ERR",msg:e.join(" ")})},warn:function(...e){return self.postMessage({channel:"WRN",msg:e.join(" ")})},info:function(...e){return self.postMessage({channel:"INF",msg:e.join(" ")})},task:function(...e){return self.postMessage({channel:"TSK",msg:e.join(" ")})}};class s extends Error{constructor(e,t="unknown"){super(e),this.line=t}}class o extends Error{constructor(e,t="unknown"){super(e),this.line=t}}function a(e,t){let n=[],s=[];for(let e in t)s.push(e),n.push(t[e]);return s.push(`return function(){\n${e}\n}`),new Function(...s)(...n)}function r(e,t){return a(e,t)()}const c={end:[],start:[]};var i={emit(e){self.postMessage({channel:"EVT",msg:e}),c[e]&&c[e].forEach((e=>e()))},on(e,t){c[e].push(t)}};let l,d=[];class u{getPath(){return this._path}setPath(e){this._path=e}getContents(){return this._contents}setContents(e){this._contents=e}confirm(){d.push(this)}unregister(){-1!=d.indexOf(this)&&d.splice(d.indexOf(this),1)}out(){return{path:this.getPath(),contents:this.getContents()}}}let h=new Set;function f(e){if(e.indexOf("<%")>-1&&e.indexOf("%>")){const t=e.replace(/\${/g,'${"${"}').replace(/\\/g,"\\\\").replace(/<%/g,"${").replace(/%>/g,"}").replace(/\`/g,"\\`");try{return r("return `"+t+"`",l)}catch(e){throw console.log(e),new s(`invalid template literal '${t}'`)}}return e}class m{constructor(e){this.segments={}}set(e,t){this.segments[e]=this.segments[e]||[],this.segments[e].push(t)}values(){return Object.values(this.segments).flat()}valuesFor(e){return Object.values(this.segments[e]||{}).flat(1/0)}reset(e){delete this.segments[e]}}const p=new u;p.setPath("./data/minecraft/functions/"+t.generatedDirectory+"/events/tick.mcfunction");const g=new m(p),k=new u;k.setPath("./data/minecraft/functions/"+t.generatedDirectory+"/events/load.mcfunction");const b=new m(k);var w={MCFunction:class extends u{constructor(e,t,n){super(),this.parent=e,this.top=t||this,this.functions=[],this.namespace="lang_error",this._path=Math.random().toString(36).substr(2),this.target=this,this.intent=n}addCommand(e){this.functions.push(f(e))}setPath(e){this._path=e}getReference(){return this.namespace+":"+this._path}out(){return{path:this.getPath(),contents:this.getContents()}}getContents(){return(t.header?t.header+"\n\n":"")+this.functions.map((e=>e.replace(/\$block/g,this.namespace+":"+this.getFunctionPath()).replace(/\$top/g,this.top.getReference()).replace(/\$parent/g,(()=>{if(this.parent)return this.parent.getReference();throw new s("$parent used where there is no valid parent.")})))).join("\n")}getPath(){return"./data/"+this.namespace+"/functions/"+this._path+".mcfunction"}getFunctionPath(){return this._path}confirm(e){h.has(this._path)||(h.add(this._path),"load"===this.intent?b.set(e,this.getReference()):"tick"===this.intent&&g.set(e,this.getReference()),super.confirm())}toString(){return"function "+this.namespace+":"+this.getFunctionPath()}static setEnv(e){h=new Set,l=e}},tickFunction:g,loadFunction:b,loadFile:k,tickFile:p,evaluate_str:f,MultiFileTag:class{constructor(e){this.segments={},this.file=new u,this.file.setPath(e),this.current=!1}set(e,t){this.current||(this.file.confirm(),this.current=!0),this.segments[e]=this.segments[e]||[],this.segments[e].push(t),this.file.setContents(JSON.stringify({replace:!1,values:Object.values(this.segments).flat(1/0)}))}reset(e){this.current=!1,delete this.segments[e],this.current||(this.file.confirm(),this.current=!0),this.file.setContents(JSON.stringify({replace:!1,values:Object.values(this.segments).flat(1/0)}))}}};const{MCFunction:x,loadFunction:v,tickFunction:y,evaluate_str:$}=w,_={};let C=0,O=0,S=0;function E(e){return O++,S+50<Date.now()&&(postMessage({type:"progress",total:C,current:O,percent:O/C,token:e[0]}),S=Date.now()),e.shift()}let j=0,F={},N=[],P=null,A=null,W={},I=new Map;function M(e,t){let n=t||[];for(let t=0;t<e.length;t++)Array.isArray(e[t])?M(e[t],n):n.push(e[t]);return n}function L(e){const t=M(Array.from(I.values()));for(let n=0;n<t.length+1;n++)if(!t.includes(n)){const t=I.get(e)||[];return t.push(n),I.set(e,t),n}}const B=(e,t)=>{try{return r(`return ${e}`,{...F,args:t.args,storage:W[t.file||"mc"],type:e=>t.args[e].type})}catch(e){throw new s(e.message,t.line)}};class D{constructor(e,t,n){this.line=e,this.token=t}[Symbol.toStringTag](){return this.token}}const T=e=>{let t=!1;return e.split("\n").reduce(((e,n,s)=>{if((n=n.trim()).startsWith("###")&&(t=!t),t||"#"===n[0]||!n)return e;if("\\"===n[0]&&"#"==n[1]&&(n=n.slice(1)),"}"===n[0]&&(e.push(new D(s,"}",!0)),n=n.slice(1)),"{"===n[n.length-1]){const t=n.slice(0,n.length-1).trim();t&&e.push(new D(s,t,!0)),e.push(new D(s,"{",!0))}else n&&e.push(new D(s,n,!0));return e}),[])};function R(e,t){const n=E(e);if(n&&n.token!=t)throw new s(`unexpected token '${n.token}' expected '${t}'`,n.line)}function G({getToken:e,actions:t,def:n}){const s=(e,t,...n)=>{const o=s.getToken(t),a=s.actions.find((e=>e.match(o)));return a?a.exec(e,t,...n):s.def(e,t,...n)};return s.actions=t.map(((e,t)=>(e.priority=t,e))),s.def=n,s.getToken=e,s.addAction=(e,t=s.actions.length)=>{e.priority=t,s.actions=[e,...s.actions].sort(((e,t)=>e.priority-t.priority))},s}function q(e,t){let n=new D(e.line,e.token);return n.file=e.file,n.args=t,n.dependencies=e.dependencies,n}_.Namespace=(e,t,n)=>{const o=$(t.substr("dir ".length));if(/[^a-z0-9_\.]/.test(o))throw new s("invalid directory name '"+o+"'",t.line);for(N.push(o.trim()),R(n,"{");"}"!=n[0].token;)_.Entry(e,n,!0);R(n,"}"),N.pop()},_.EntryOp=G({getToken:e=>e[0],actions:[{match:({token:e})=>/dir .+/.test(e),exec(e,t){_.Namespace(e,E(t).token,t)}},{match:({token:e})=>/function .+/.test(e),exec(e,t){_.Function(e,t)}},{match:({token:e})=>/clock .+/.test(e),exec(e,t){const{token:n}=t[0],s=n.substr(6);E(t);const o=_.Block(e,t,"clock",{prepend:["schedule function $block "+s]});v.set(e,o.substr(9))}},{match:({token:e})=>/^LOOP/.test(e),exec(e,t){const n=E(t);_.Loop(e,n.token,t,!0,_.Entry)}},{match:({token:e})=>/^!IF\(/.test(e),exec(e,t){const n=E(t),{token:s}=n,o=s.substr(4,s.length-5);if(R(t,"{"),B(o,n)){for(;"}"!=t[0].token;)_.Entry(e,t,!0);R(t,"}")}else{let e=1;for(;e&&t.length;){let n=E(t).token;"{"===n&&e++,"}"===n&&e--}}}},{match:({token:e})=>/^!.+/.test(e),exec(e,t){const n=t[0],{token:s}=n,o=s.substr(1);if(E(t),R(t,"{"),B(o,n)){for(;"}"!=t[0].token;)_.Entry(e,t,!0);R(t,"}")}else{let e=1;for(;e&&t.length;){let n=E(t).token;"{"===n&&e++,"}"===n&&e--}}}}],def:(e,t)=>{const n=E(t);throw new s(`unexpected token '${n.token}' before ${t[0]?t[0].token.length>10?t[0].token.substr(0,10)+"...":t[0].token:"EOF"}`,n.line)}}),_.Entry=(e,t,n)=>{if(n)_.EntryOp(e,t);else for(;t[0];)_.EntryOp(e,t)},_.Function=(e,t,n={})=>{const o=E(t);let a=o.token.substr(9);if(a=$(a),/[^a-z0-9_\.]/.test(a))throw new s("invalid function name '"+a+"'",o.line);const r=new x(void 0,void 0,a);for(r.namespace=N[0],r.setPath(N.slice(1).concat(a).join("/")),R(t,"{");"}"!=t[0].token&&t[0];)_.Generic(e,t,r,r,r);if(R(t,"}"),n.append)for(let e of n.append)r.addCommand(e);return r.confirm(e),r},_.Generic=G({getToken:e=>e[0],actions:[{match:({token:e})=>"load"===e,exec(e,t){E(t);const n=_.Block(e,t,"load",{dummy:!0},null,null);for(let e=0;e<n.functions.length;e++)P.addCommand(n.functions[e])}},{match:({token:e})=>"tick"===e,exec(e,t){E(t);const n=_.Block(e,t,"tick",{dummy:!0},null,null);for(let e=0;e<n.functions.length;e++)A.addCommand(n.functions[e])}},{match:({token:e})=>e.startsWith("warn "),exec(e,t){const{token:s}=E(t);n.warn($(s.substr(5).trim()))}},{match:({token:e})=>e.startsWith("error "),exec(e,t){const n=E(t),{token:s}=n;throw new o(s.substr(5).trim(),n.line)}},{match:({token:e})=>/^execute\s*\(/.test(e),exec(e,n,s,o,a){let{token:r}=E(n),c=r.substring(r.indexOf("(")+1,r.length-1);for(s.addCommand(`scoreboard players set #execute ${t.internalScoreboard} 0`),s.addCommand(`execute ${c} run ${_.Block(e,n,"conditional",{append:[`scoreboard players set #execute ${t.internalScoreboard} 1`]},o,a)}`);/^else execute\s*\(/.test(n[0].token);)r=E(n).token,c=r.substring(r.indexOf("(")+1,r.length-1),s.addCommand(`execute if score #execute ${t.internalScoreboard} matches 0 ${c} run ${_.Block(e,n,"conditional",{append:[`scoreboard players set #execute ${t.internalScoreboard} 1`]},o,a)}`);/^else/.test(n[0].token)&&(E(n),s.addCommand(`execute if score #execute ${t.internalScoreboard} matches 0 run ${_.Block(e,n,"conditional",{},o,a)}`))}},{match:({token:e})=>/^!IF\(/.test(e),exec(e,t,n){const s=E(t),{token:o}=s,a=o.substr(4,o.length-5);if(R(t,"{"),B(a,s)){for(;"}"!=t[0].token;)_.Generic(e,t,n);R(t,"}")}else{let e=1;for(;e&&t.length;){let n=E(t).token;"{"===n&&e++,"}"===n&&e--}}}},{match:({token:e})=>/^!.+/.test(e),exec(e,t,n){const s=E(t),{token:o}=s,a=o.substr(1);if(R(t,"{"),B(a,s)){for(;"}"!=t[0].token;)_.Generic(e,t,n);R(t,"}")}else{let e=1;for(;e&&t.length;){let n=E(t).token;"{"===n&&e++,"}"===n&&e--}}}},{match:({token:e})=>/^block|^{/.test(e),exec(e,t,n,s){"block"===t[0].token&&E(t),n.addCommand(_.Block(e,t,"block",{},s,null))}},{match:({token:e})=>e.startsWith("execute")&&-1!=e.indexOf("run"),exec(e,t,n,s,o){const a=E(t),{token:r}=a,c=r.substr(r.lastIndexOf("run")+3).trim(),i=r.substr(0,r.lastIndexOf("run")+3).trim();let l=!0;if(c){l=!1;let r=a;for(let e=0;e<t.length&&t[e].line===r.line;e++)r=t[e];const d=[];let u=1;if(r&&"{"===r.token){let e=E(t);for(d.push(e);t.length&&u||e.line==t[0].line;)"{"===t[0].token&&u++,"}"===t[0].token&&u--,e=E(t),d.push(e)}let h=q(a,a.args);t.unshift(...d,h),h.token="}",h=q(a,a.args),t.unshift(h),h.token=c,h=q(a,a.args),t.unshift(h),h.token="{",C+=3;const f=_.Block(e,t,"execute",{dummy:!0},l?s:n,l?o:n);f.confirm(e),n.addCommand(i+" function "+f.getReference())}else n.addCommand(r)}},{match:({token:e})=>/^LOOP/.test(e),exec(e,t,n){const{token:s}=E(t);_.Loop(e,s,t,n,_.Generic,null,null)}},{match:({token:e})=>/until\s*\(/.test(e),exec(e,n,s,o,a){const{token:r}=E(n),c=r.substr(6,r.length-7),i=c.substr(0,c.lastIndexOf(",")).trim(),l=c.substr(c.lastIndexOf(",")+1).trim(),d=L(e),u=_.Block(e,n,"until",{prepend:[`scoreboard players set #until_${d} ${t.internalScoreboard} 1`]},o,null),h=new x,f=t.generatedDirectory+"/until/"+(j.until=(null==j.until?-1:j.until)+1);h.namespace=N[0],h.setPath(N.slice(1).concat(f).join("/")),h.addCommand(`scoreboard players set #until_${d} ${t.internalScoreboard} 0`),h.addCommand(`execute ${i} run ${u}`),h.addCommand(`execute if score #until_${d} ${t.internalScoreboard} matches 0 run schedule function $block ${l}`),h.confirm(e),s.addCommand(`function ${h.getReference()}`)}},{match:({token:e})=>/^async while/.test(e),exec(e,n,s,o){let{token:a}=E(n);const r=a.substr(12,a.length-13),c=r.substr(0,r.lastIndexOf(",")).trim(),i=r.substr(r.lastIndexOf(",")+1).trim(),l=new x,d=L(e),u=t.generatedDirectory+"/while/"+(j.while=(null==j.while?-1:j.while)+1);l.namespace=N[0],l.setPath(N.slice(1).concat(u).join("/"));const h=_.Block(e,n,"while",{append:[`scoreboard players set #WHILE_${d} ${t.internalScoreboard} 1`,`schedule function ${l.getReference()} ${i}`]},o,s);if(l.addCommand(`scoreboard players set #WHILE_${d} ${t.internalScoreboard} 0`),l.addCommand(`execute ${c} run ${h}`),/^finally$/.test(n[0].token)){a=E(n).token;const o=_.Block(e,n,"while",{},l,s);l.addCommand(`execute if score #WHILE_${d} ${t.internalScoreboard} matches 0 run ${o}`)}l.confirm(e),s.addCommand(`function ${l.getReference()}`)}},{match:({token:e})=>/^while/.test(e),exec(e,n,s,o){let{token:a}=E(n);const r=a.substr(6,a.length-7).trim(),c=new x,i=t.generatedDirectory+"/while/"+(j.while=(null==j.while?-1:j.while)+1),l=L(e);c.namespace=N[0],c.setPath(N.slice(1).concat(i).join("/"));const d=_.Block(e,n,"while",{append:[`scoreboard players set #WHILE_${l} ${t.internalScoreboard} 1`,`function ${c.getReference()}`]},o,s);if(c.addCommand(`scoreboard players set #WHILE_${l} ${t.internalScoreboard} 0`),c.addCommand(`execute ${r} run ${d}`),/^finally$/.test(n[0].token)){a=E(n).token;const o=_.Block(e,n,"while",{},c,s);c.addCommand(`execute if score #WHILE_${l} ${t.internalScoreboard} matches 0 run ${o}`)}c.confirm(e),s.addCommand(`function ${c.getReference()}`)}},{match:({token:e})=>/^schedule\s?((\d|\.)+(d|t|s)|<%.+)\s?(append|replace){0,1}$/.test(e),exec(e,t,n,s,o){const{token:a}=E(t),r=_.Block(e,t,"schedule",{},s,o),[,c,i]=$(a).split(/\s+/);n.addCommand(`schedule ${r} ${c} ${i}`.trim())}},{match:({token:e})=>"sequence"===e,exec(e,n,s){E(n);const o=_.Block(e,n,"sequence",{dummy:!0},null,null),a=e=>{let t=+e.substr(0,e.length-1);switch(e[e.length-1]){case"s":t*=20;break;case"d":t*=24e3}return t},r={};let c=0;for(let e of o.functions)if(e.startsWith("delay")){c+=a(e.substr(6).trim())}else if(e.startsWith("setdelay")){c=a(e.substr(9).trim())}else r[c]=r[c]||[],r[c].push(e);for(let e in r)if(0==e)for(const t of r[e])s.addCommand(t);else{const n=new x,o=t.generatedDirectory+"/sequence/"+(j.sequence=(null==j.sequence?-1:j.sequence)+1);n.namespace=N[0],n.setPath(N.slice(1).concat(o).join("/"));for(const t of r[e])n.addCommand(t);s.addCommand(`schedule ${n.toString()} ${e}t replace`),n.confirm()}}},{match:({token:e})=>"("===e,exec(e,t,n){E(t);let s="",o=E(t);for(;")"!=o.token;)s+=o.token+" ",o=E(t);n.addCommand(s.trim())}}],def(e,t,n,s,o){const a=E(t),{token:r}=a;n.addCommand(r)}}),_.Block=(e,n,s,o={},a,r)=>{R(n,"{"),s||(s="none");let c=null;if(n[0].token.startsWith("name ")){const e=E(n).token;c=$(e.substr(5)).trim()}else c=t.generatedDirectory+"/"+s+"/"+(j[s]=(null==j[s]?-1:j[s])+1);const i=new x(a,r);if(null===r&&(r=i),i.namespace=N[0],i.setPath(N.slice(1).concat(c).join("/")),o.prepend)for(let e of o.prepend)i.addCommand(e);for(;"}"!=n[0].token&&n[0];)_.Generic(e,n,i,i,"conditional"==s?r:i);if(o.append)for(let e of o.append)i.addCommand(e);return R(n,"}"),o.dummy?i:(i.confirm(e),i.toString())},_.Loop=(e,t,n,s,o=_.Generic,a,r)=>{let[c,i]=t.substring(t.indexOf("(")+1,t.length-1).split(",").map((e=>e.trim()));if(-1!=t.indexOf("[")){const e=t.substring(t.indexOf("(")+1,t.length-1).split(",");i=e.pop(),c=e.join(",")}if(c=B(c,t),R(n,"{"),Array.isArray(c)){for(let t=0;t<c.length-1;t++){const l=[...n];for(F[i]=c[t];"}"!=l[0].token&&l.length;)o(e,l,s,a,r)}F[i]=c[c.length-1]}else{for(let t=0;t<c-1;t++){const c=[...n];for(F[i]=t;"}"!=c[0].token&&c.length;)o(e,c,s,a,r)}F[i]=c-1}for(;"}"!=n[0].token&&n.length;)o(e,n,s,a,r);R(n,"}"),delete F[i]};const H=new w.MultiFileTag("./data/minecraft/tags/functions/tick.json"),z=new w.MultiFileTag("./data/minecraft/tags/functions/load.json");function J(e,n,o,a){o&&Object.assign(t,o);let r="dummy";i.emit("start"),function(e){I.delete(e)}(r),hashes=new Map,included_file_list=[],N=[n],Array.isArray(a)&&N.push(...a),t.defaultNamespace&&N.unshift(t.defaultNamespace),P=new x(null,null,"load"),P.namespace=N[0],P.setPath(N.slice(1).concat(t.generatedDirectory+"/load").join("/")),A=new x(null,null,"tick"),A.namespace=N[0],A.setPath(N.slice(1).concat(t.generatedDirectory+"/tick").join("/")),v.reset(r),y.reset(r),z.reset(r),H.reset(r),W={},F={config:t,file_path:r},x.setEnv(F),ifId=0,j={};try{let t=T(e);C=t.length,_.Entry(r,t),P.functions.length>0&&(P.functions=Array.from(new Set(P.functions).keys()),P.confirm(r)),A.functions.length>0&&A.confirm(r);const n=v.valuesFor(r);n.length>0&&z.set(r,n);const s=y.valuesFor(r);s.length>0&&H.set(r,s),i.emit("end")}catch(e){throw i.emit(e.message),"Cannot read property 'token' of undefined"===e.message?new s("expected more tokens","EOF"):e}}const K={on(e,t){i.on(e,t)},io:{loadFunction:v,tickFunction:y,TickTag:H,LoadTag:z,MCFunction:x},getEnv:()=>F,getNamespace(e){const t=N.slice(1).join("/");return{namespace:N[0],path:t+(0===t.length?"":"/")}},transpiler:{tokenize:T,evaluate_str:$,consumer:_,validate_next_destructive:R,list:G,evaluators:{code:{evaluateCodeWithEnv:r,getFunctionWithEnv:a}}}},V={blocks:"blocks",entities:"entity_types",fluids:"fluids",functions:"functions",items:"items"};let Q={};const U={resolve:(...e)=>e.join("/")},X={cwd:()=>"."},Y=(e,t)=>{try{return K.transpiler.evaluators.code.evaluateCodeWithEnv(`return ${e}`,K.getEnv())}catch(e){return!0}};function Z(e,t){return{match:({token:t})=>t.startsWith(e),exec(e,n){const{token:s}=n.shift(),o=s.indexOf(" ")+1,a=s.substr(o,s.length),r=new u;r.setPath(K.transpiler.evaluate_str(t(a,e))),K.transpiler.validate_next_destructive(n,"{");let c=1,i=["{"];for(;c&&n.length;){const e=n.shift().token;i.push(K.transpiler.evaluate_str(e)),"{"===e&&c++,"}"===e&&c--}r.setContents(i.join("")),r.confirm()}}}const ee=K.transpiler.list({getToken:e=>e[0],actions:[{match:({token:e})=>/^LOOP/.test(e),exec(e,t,n){const{token:s}=t.shift();K.transpiler.consumer.Loop(e,s,t,n,ee)}},{match:({token:e})=>/^!IF\(/.test(e),exec(e,t,n){const s=t.shift(),{token:o}=s,a=o.substr(4,o.length-5);if(t.shift(),K.transpiler.validate_next_destructive(t,"{"),Y(a)){for(;"}"!=t[0].token;)ee(e,t,n);K.transpiler.validate_next_destructive(t,"}")}else{let e=1;for(;e&&t.length;){let n=t.shift().token;"{"===n&&e++,"}"===n&&e--}}}},{match:({token:e})=>/^!.+/.test(e),exec(e,t,n){const{token:s}=t[0],o=s.substr(1);if(t.shift(),K.transpiler.validate_next_destructive(t,"{"),Y(o)){for(;"}"!=t[0].token;)ee(e,t,n);K.transpiler.validate_next_destructive(t,"}")}else{let e=1;for(;e&&t.length;){let n=t.shift().token;"{"===n&&e++,"}"===n&&e--}}}}],def:(e,t,n)=>{const{token:s}=t.shift();n.values.add(K.transpiler.evaluate_str(s))}}),te=K.transpiler,ne=te.consumer.Generic,se=te.consumer.EntryOp;ne.addAction({match:({token:e})=>e.startsWith("tags"),exec(e,t,n){const s=t.shift(),{token:o}=s,[,a,r,c]=o.split(/\s+/);if("add"!==r)throw new CompilerError(`invalid tag action '${r}'`,s.line);Q.tags[a].values.add(K.transpiler.evaluate_str(c))}}),se.addAction({match:({token:e})=>/^(blocks|entities|fluids|functions|items)/.test(e),exec(e,t){const{token:n}=t.shift(),[s,o,a]=n.split(/\s+/),r=Q.tags[K.transpiler.evaluate_str(o)]={type:V[s],replace:"replace"===a,values:new Set,namespace:K.getNamespace()};for(K.transpiler.validate_next_destructive(t,"{");"}"!=t[0].token;)ee(e,t,r);t.shift()}}),se.addAction(Z("loot",(e=>{const t=K.getNamespace();return U.resolve("data",t.namespace,"loot_tables",t.path+e+".json")}))),se.addAction(Z("predicate",(e=>{const t=K.getNamespace();return U.resolve(X.cwd(),"data",t.namespace,"predicates",t.path+e+".json")}))),se.addAction(Z("modifier",(e=>{const t=K.getNamespace();return U.resolve(X.cwd(),"data",t.namespace,"item_modifiers",t.path+e+".json")}))),se.addAction(Z("recipe",(e=>{const t=K.getNamespace();return U.resolve(X.cwd(),"data",t.namespace,"recipes",t.path+e+".json")}))),se.addAction(Z("advancement",(e=>{const t=K.getNamespace();return U.resolve(X.cwd(),"data",t.namespace,"advancements",t.path+e+".json")}))),K.on("start",(e=>{Q={tags:{}}})),K.on("end",(e=>{for(const e in Q.tags){const t=Q.tags[e],n=new u;n.setPath(U.resolve(X.cwd(),"data",t.namespace.namespace,"tags",t.type,t.namespace.path+e+".json")),n.setContents(JSON.stringify({replace:t.replace,values:Array.from(t.values)})),n.confirm()}})),self.onmessage=e=>{J(e.data.contents,e.data.namespace,e.data.config,e.data.dir),self.postMessage(d.map((e=>e.out())))};